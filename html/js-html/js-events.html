<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>events</title>
    <!-- Goodle font -->
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik+Wet+Paint&display=swap" rel="stylesheet"> -->
    
    <!-- modern-normalize -->
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/modern-normalize/1.0.0/modern-normalize.min.css"
    />

    <!-- css -->
    <link rel="stylesheet" href="../../css/styles-basic.css">
    <link rel="stylesheet" href="../../css/style-js-events.css">
</head>

<body>
    <header>
        <div>
            <a  class="fixed-back" href="../../index.html">Back to main page</a>
            <nav>
            </nav>
        </div>
    </header>

    <main>
        <section class="section-title">
            <div class="container">
                <h1>Events. Поширення подій та оптимізація</h1>
            </div>
        </section>

        <section class="section-menu">
            <div class="container">
                <h2>Зміст</h2>
                <ol>
                    <li>Поширення подій</li>
                    <li></li>
                    <li>Делегування подій</li>
                    <li>Throttle і Debounce (Скрол)</li>
                    <li></li>
      
                </ol>
            </div>
        </section>


        <section class="section-about">
            <div class="container">
                <h2>Поширення подій</h2>
                <p>
                    життєвий цикл події, який має три етапи: занурення, таргетинг і спливання.
                    На практиці найчастіше використовують тільки фазу спливання.
                </p>
                <p>
                    Під час настання події, вона проходить через три обов'язкові фази:
                </p>
                <ul>
                    <li>
                        Capturing phase (занурення) - подія починається на window і тоне (проходить через 
                        усі елементи-предки) до найглибшого цільового елемента, на якому відбулася дія, 
                        наприклад, клік.
                    </li>
                    <li>
                        Target phase (таргетинг) - подія дійшла до цільового елемента. Цей етап містить тільки 
                        повідомлення елемента про те, що на ньому відбулася дія
                    </li>
                    <li>
                        Bubbling phase (спливання) - кінцева фаза, подія спливає від найглибшого, цільового елемента, 
                        через усі елементи-предки до window.
                    </li>
                </ul>

                <h3>Спливання подій</h3>
                <p><a href="https://codepen.io/goit-academy/pen/QWpBwaa" target="_blank">codepen</a></p>
                <p>
                    Спливають майже всі події, наприклад, події focus і blur не спливають, тому існують 
                    їх спливаючі аналоги - focusin і focusout.
                </p>

                <h3>Властивість event.target</h3>

                <p>
                    Незалежно від того, де ми спіймали подію під час її спливання, завжди можна дізнатися, 
                    де саме вона відбулася. Найглибший елемент, який викликає подію, називається цільовим або 
                    вихідним, і доступний як event.target.
                </p>
                <p>
                    <b>.event.target</b> - це посилання на вихідний елемент, на якому відбулася подія, в процесі 
                    спливання вона - незмінна.
                </p>
                <p>
                    <b>.event.currentTarget</b> - це посилання на поточний елемент, до якого дійшло спливання, 
                    на ньому зараз виконується обробник події.
                </p>
                <p>
                    Якщо слухач події зареєстрований на найвищому елементі, то він «спіймає» усі кліки всередині, 
                    тому що події будуть спливати до цього елемента. Відкрийте консоль в прикладі і поклікайте, 
                    event.target - це завжди вихідний (і найглибший) елемент, на якому був клік, 
                    а event.currentTarget не змінюється.
                </p>
                <pre>
    <a href="https://codepen.io/goit-academy/pen/JjWBoqd" target="_blank">codepen</a>
    const parent = document.querySelector("#parent");

    parent.addEventListener("click", (event) => {
      console.log("event.target: ", event.target);
      console.log("event.currentTarget: ", event.currentTarget);
    });</pre>
                

                <h3>Припинення спливання <b>stopPropagation()</b></h3>
                <p>
                    Зазвичай, подія буде спливати вгору до елемента window, викликаючи усі обробники на 
                    своєму шляху. Але будь-який проміжний обробник може вирішити, що подія повністю 
                    оброблена і зупинити спливання, викликавши метод <b>stopPropagation()</b>
                </p>
                

                <pre>
    <a href="https://codepen.io/goit-academy/pen/gOmjpwo" target="_blank">codepen</a>
    const parent = document.querySelector("#parent");
    const child = document.querySelector("#child");
    const descendant = document.querySelector("#descendant");

    parent.addEventListener("click", () => {
      alert(
        "Parent click handler!"
      );
    });

    child.addEventListener("click", () => {
      alert(
        "Child click handler!"
      );
    });

    descendant.addEventListener("click", (event) => {
      event.stopPropagation();
      alert("Descendant click handler");
    });</pre>
                
                <p>
                    <b>stopImmediatePropagation()</b>
                    Якщо елемент має декілька обробників на одну подію, то, навіть у разі припинення спливання, 
                    усі вони будуть виконані. Тобто метод stopPropagation() тільки перешкоджає просуванню події 
                    далі. Якщо необхідно повністю зупинити обробку події, використовується метод 
                    stopImmediatePropagation(). Він не тільки запобігає спливанню, але й зупиняє обробку 
                    подій на поточному елементі.
                </p>


            </div>
        </section>


        <section class="section-about">
            <div class="container">
                <h2>Делегування подій</h2>
                <p>
                    Спливання дозволяє реалізувати один із найкорисніших прийомів - делегування подій 
                    (event delegation). Він полягає у тому, що, якщо є група елементів, події яких 
                    потрібно обробляти однаково, то додається один обробник на їх загального предка, 
                    замість того, щоб додавати обробник до кожного елемента. Використовуючи властивість 
                    event.target, можна отримати посилання на цільовий елемент, зрозуміти, на якому саме 
                    дочірньому елементі відбулася подія, і обробити її.
                </p>
                <p>
                    делегування зводиться до трьох простих кроків.
                </p>
                <ul>
                    <li>Визначити спільного предка групи елементів для відстеження подій.</li>
                    <li>
                        Зареєструвати на елементі-предку обробник події, яку ми хочемо відловлювати з групи елементів.
                    </li>
                    <li>
                        В обробнику використовувати <b>event.target</b> для вибору цільового елемента.
                    </li>
                </ul>
                <h4>Палітра кольорів</h4>
                <p>
                    Будемо створювати палітру кольорів з можливістю вибрати колір по кліку і 
                    відображенням обраного кольору
                </p>
                <pre>
    <a href="https://codepen.io/goit-academy/pen/GRWBodN" target="_blank">codepen</a>        
    p class="output"Selected color: /p
    div class="color-palette"/div
                </pre>
                <p>Дивись js код</p>

                <!-- Example -->
                <p class="output-events">Selected color: -</p>
                <div class="color-palette"></div>
                <!-- Example end -->
                <pre>
    function selectColor(event) {
        if (event.target.nodeName !== "BUTTON") {
          return;
        }
        const selectedColor = event.target.dataset.color;
    } </pre>
                
            </div>
        </section>


        <section class="section-about">
            <div class="container">
                <h2>CDNjs</h2>
                <h3>Lodash</h3>
                <p>Як пыдключити?</p>
                <ul>
                    <li>
                        Заходимо сюди 
                        <a href="https://cdnjs.com/libraries/lodash.js" 
                            target="_blank" rel="noopener noreferrer">cdn lodash</a>
                    </li>
                    <li>копіюємо тег як на фото та вставляємо перед тегом боді як зроблено тут</li>
                    <li>У js файлі не імпортуємо а відразу користуємось</li>
                </ul>
                <pre>
    const result = _.add(2, 3);
    console.log(result); // 5 </pre>
                
                <div>
                    <img src="../../img/lodash.JPG" alt="lodash">
                </div>

                
                <p><a href="https://cdnjs.com/" target="_blank" rel="noopener noreferrer">cdn library</a></p>
                <p>
                    <a href="https://caniuse.com" target="_blank" rel="noopener noreferrer">
                        Підтримка браузерів
                    </a>
                </p>
            </div>
        </section>




        <section class="section-about">
            <div class="container">
                <h2>Throttle і Debounce</h2>
                <p>
                    Наприклад, якщо додати слухача події до скролу, то під час прокручування сторінки 
                    мишкою можна викликати близько 30 подій на секунду.
                    Якщо обробник події скролу виконує важкі обчислення та інші DOM-маніпуляції, 
                    гарантовано виникнуть проблеми з продуктивністю.
                </p>

                <p class="cta">Scroll me</p>
                <div class="event-counter">
                    <div class="box">
                      <p>Number of scroll events</p>
                      <span class="output">0</span>
                    </div>
                </div>

                <p>
                    Throttle і Debounce - це два схожих, але різних за поведінкою прийоми, що дозволяють 
                    контролювати кількість разів, яку ми дозволяємо виконувати функції з часом. 
                    Використовуємо їх реалізацію з бібліотеки Lodash.
                </p>

                <h4>Підключення бібліотеки <a href="https://lodash.com/" target="_blank" rel="noopener noreferrer">Lodash</a></h4>

                <p>
                    Підключимо до проекту бібліотеку Lodash через CDN. Для цього використаємо сервіс cdnjs.com і 
                    додамо посилання на скрипт бібліотеки в кінці HTML
                </p>
                <p>
                    Тепер ми можемо отримати доступ до бібліотеки у нашому скрипті. При підключенні бібліотек через CDN, 
                    до об'єкта window додається властивість, в якій зберігається те, що надає бібліотека. Ім'я цієї 
                    властивості унікальне для бібліотеки та описане в її документації. Для Lodash - це 
                    символ нижнього підкреслення _. Для перевірки використовуємо метод add, який просто додає два числа.
                </p>


                <h3>Throttle</h3>
                
            </div>
        </section>


        <section class="section-about">
            <div class="container">
                <h2></h2>
            </div>
        </section>

    </main>
    <footer class="page-footer">
        <div class="container">
            <h3>footer</h3>
            <address>
                <p>address</p>
            </address>
        </div>
    </footer>

    <!-- Lodash library script file -->
    <!-- <script
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"
      integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script> -->

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js" 
        integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ==" 
        crossorigin="anonymous" referrerpolicy="no-referrer">
    </script>
    <script src="../../js/events.js"></script>
</body>
</html>